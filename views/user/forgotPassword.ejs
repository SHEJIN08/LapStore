<%- include('../partials/header') %>
<link rel="stylesheet" href="/css/user/forgotPassword.css">


<body>

    <header class="main-header">
        <a href="#" class="logo">
            <div class="logo-icon">
                <img src="https://img.icons8.com/ios-filled/50/ffffff/laptop.png" alt="LapStore Logo Icon" width="18">
            </div>
            <span class="logo-name">LapStore</span>
        </a>
        
        <nav class="main-nav">
            <a href="#">Home</a>
            <a href="#">Brands</a>
            <a href="#">About Us</a>
            <a href="#">Contact</a>
        </nav>
        
        <div class="header-icons">
            <a href="#"><i class='bx bx-search'></i></a>
            <a href="#"><i class='bx bx-user'></i></a>
            <a href="#"><i class='bx bx-cart'></i></a>
        </div>
    </header>

    <main class="main-content">
        <div class="forgot-password-container">
            <h1>Forgot Password?</h1>
            <p>Enter your registered email to receive an OTP.</p>
            
            <form id="forgotForm">
                <input type="text" placeholder="Email" name="email" class="email" id="email" required>
                <button type="submit" class="btn-primary">Send OTP</button>
            </form>
        </div>
    </main>

    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-col">
                <a href="#" class="logo footer-logo">
                    <div class="logo-icon">
                        <img src="https://img.icons8.com/ios-filled/50/ffffff/laptop.png" alt="LapStore Logo Icon" width="18">
                    </div>
                    <span class="logo-name">LapStore</span>
                </a>
                <p class="footer-about">
                    Your one-stop shop for the latest mobile technology. We offer the best prices and fast, reliable shipping.
                </p>
            </div>
            
            <div class="footer-col">
                <h4>Shop</h4>
                <ul>
                    <li><a href="#">Latest Launches</a></li>
                    <li><a href="#">Popular</a></li>
                    <li><a href="#">Best Sellers</a></li>
                    <li><a href="#">All Brands</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h4>Company</h4>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">Press</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h4>Help</h4>
                <ul>
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">FAQ</a></li>
                    <li><a href="#">Shipping & Returns</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h4>Follow Us</h4>
                <div class="social-icons">
                    <a href="#"><i class='bx bxl-facebook'></i></a>
                    <a href="#"><i class='bx bxl-twitter'></i></a>
                    <a href="#"><i class='bx bxl-instagram'></i></a>
                    <a href="#"><i class='bx bxl-youtube'></i></a>
                </div>
            </div>
        </div>
    </footer>


    <%- include('../partials/footer') %>

    <script src="/js/axios.min.js"></script>
   

    <script>
        const forgotForm = document.getElementById('forgotForm');

        const showToast = (message, type) => {
            const bgColor = type === 'success' ? "#28a745" : "#dc3545";
            Toastify({
                text: message,
                duration: 3000,
                gravity: "top", 
                position: "right", 
                style: { background: bgColor }
            }).showToast();
        };

        forgotForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            // 4. Get the email value
            const email = document.getElementById('email').value;

            if (!email) {
                showToast("Please enter your email", "error");
                return;
            }

            try {
                // 5. Send POST request
                const response = await axios.post('/user/forgot-password', { 
                    email: email 
                });

                if (response.data.success) {
                    showToast(response.data.message, 'success');
                    
                    // 6. Redirect to OTP page after success
                    setTimeout(() => {
                        window.location.href = '/user/verify-otp'; 
                    }, 1500);
                } else {
                    showToast(response.data.message || 'Failed to send OTP', 'error');
                }

            } catch (error) {
                console.error(error);
                const errMsg = error.response?.data?.message || 'Something went wrong';
                showToast(errMsg, 'error');
            }
        });
    </script>
</body>